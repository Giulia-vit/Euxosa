{"version":3,"sources":["../../../server/lib/logging.ts"],"sourcesContent":["import { ISettingsParam, Logger } from 'tslog'\nimport { loadConfigAtRuntime, LogLevel } from '../config-shared'\n\n// eslint-disable-next-line\ndeclare module globalThis {\n  let _blitz_baseLogger: Logger\n  let _blitz_logLevel: LogLevel\n}\n\nexport const newline = () => {\n  globalThis._blitz_logLevel =\n    globalThis._blitz_logLevel ?? loadConfigAtRuntime().log?.level\n\n  const logLevel = globalThis._blitz_logLevel\n\n  switch (logLevel) {\n    case 'trace':\n    case 'debug':\n    case 'info':\n      console.log(' ')\n      break\n    case 'warn':\n    case 'error':\n    case 'fatal':\n    default:\n      //nothing\n      break\n  }\n}\n\nexport const baseLogger = (options?: ISettingsParam): Logger => {\n  if (globalThis._blitz_baseLogger) return globalThis._blitz_baseLogger\n\n  let config\n  try {\n    config = loadConfigAtRuntime()\n  } catch {\n    config = {}\n  }\n\n  globalThis._blitz_baseLogger = new Logger({\n    minLevel: config.log?.level || 'info',\n    type: config.log?.type || 'pretty',\n    dateTimePattern:\n      process.env.NODE_ENV === 'production'\n        ? 'year-month-day hour:minute:second.millisecond'\n        : 'hour:minute:second.millisecond',\n    displayFunctionName: false,\n    displayFilePath: 'hidden',\n    displayRequestId: false,\n    dateTimeTimezone:\n      process.env.NODE_ENV === 'production'\n        ? 'utc'\n        : Intl.DateTimeFormat().resolvedOptions().timeZone,\n    prettyInspectHighlightStyles: {\n      name: 'yellow',\n      number: 'blue',\n      bigint: 'blue',\n      boolean: 'blue',\n    },\n    maskValuesOfKeys: ['password', 'passwordConfirmation'],\n    exposeErrorCodeFrame: process.env.NODE_ENV !== 'production',\n    ...options,\n  })\n\n  return globalThis._blitz_baseLogger\n}\n"],"names":[],"mappings":";;;;;AAAuC,GAAO,CAAP,MAAO;AACA,GAAkB,CAAlB,aAAkB;AAQzD,KAAK,CAAC,OAAO,OAAS,CAAC;QAEI,GAAyB;QAAvD,gBAA0B;IAD5B,UAAU,CAAC,eAAe,IACxB,gBAA0B,GAA1B,UAAU,CAAC,eAAe,cAA1B,gBAA0B,cAA1B,gBAA0B,IAAI,GAAyB,OAVb,aAAkB,wBAUR,GAAG,cAAzB,GAAyB,UAAzB,CAAgC,QAAhC,CAAgC,GAAhC,GAAyB,CAAE,KAAK;IAEhE,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC,eAAe;WAEnC,QAAQ;cACT,KAAO;cACP,KAAO;cACP,IAAM;YACT,OAAO,CAAC,GAAG,EAAC,CAAG;;cAEZ,IAAM;cACN,KAAO;cACP,KAAO;;;;AAKhB,CAAC;QAnBY,OAAO,GAAP,OAAO;AAqBb,KAAK,CAAC,UAAU,IAAI,OAAwB,GAAa,CAAC;QAWnD,GAAU,EACd,IAAU;IAXlB,EAAE,EAAE,UAAU,CAAC,iBAAiB,SAAS,UAAU,CAAC,iBAAiB;IAErE,GAAG,CAAC,MAAM;QACN,CAAC;QACH,MAAM,OAlCoC,aAAkB;IAmC9D,CAAC,QAAO,CAAC;QACP,MAAM;;IACR,CAAC;IAED,UAAU,CAAC,iBAAiB,GAAG,GAAG,CAxCG,MAAO;QAyC1C,QAAQ,IAAE,GAAU,GAAV,MAAM,CAAC,GAAG,cAAV,GAAU,UAAV,CAAiB,QAAjB,CAAiB,GAAjB,GAAU,CAAE,KAAK,MAAI,IAAM;QACrC,IAAI,IAAE,IAAU,GAAV,MAAM,CAAC,GAAG,cAAV,IAAU,UAAV,CAAgB,QAAhB,CAAgB,GAAhB,IAAU,CAAE,IAAI,MAAI,MAAQ;QAClC,eAAe,EACb,OAAO,CAAC,GAAG,CAAC,QAAQ,MAAK,UAAY,KACjC,6CAA+C,KAC/C,8BAAgC;QACtC,mBAAmB,EAAE,KAAK;QAC1B,eAAe,GAAE,MAAQ;QACzB,gBAAgB,EAAE,KAAK;QACvB,gBAAgB,EACd,OAAO,CAAC,GAAG,CAAC,QAAQ,MAAK,UAAY,KACjC,GAAK,IACL,IAAI,CAAC,cAAc,GAAG,eAAe,GAAG,QAAQ;QACtD,4BAA4B;YAC1B,IAAI,GAAE,MAAQ;YACd,MAAM,GAAE,IAAM;YACd,MAAM,GAAE,IAAM;YACd,OAAO,GAAE,IAAM;;QAEjB,gBAAgB;aAAG,QAAU;aAAE,oBAAsB;;QACrD,oBAAoB,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,MAAK,UAAY;WACxD,OAAO;;WAGL,UAAU,CAAC,iBAAiB;AACrC,CAAC;QApCY,UAAU,GAAV,UAAU"}